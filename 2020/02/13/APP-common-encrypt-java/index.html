<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="鹿桥">
  <meta name="keyword" content="bin">
  
    <link rel="shortcut icon" type="image/ico" href="/css/images/logo.png"/>
  
  <title>
    
      APP中常见加密算法java实现 | 鹿桥的航海日志
    
  </title>
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"></script>
  
  
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


<meta name="generator" content="Hexo 4.2.1"></head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>鹿桥的航海日志</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>APP中常见加密算法java实现</h2>
  <p class="post-date">2020-02-13</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p>在平时对 APP 的分析中，关于网络协议这一块的分析是很重要的一部分。但，几乎所有的 app 都有对网络协议进行加密。这些加密算法常会用在 APP 和服务器的交互数据中发包和返回包，同时一些签名也会用到。为了更快的识别这些算法，我整理了一些常见的对称加密和非对称加密算法的 java 实现，在 so 层逆向中，也类似。</p>
<h4 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加密</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Encrypt</span><span class="params">(String Src, String Key)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (Key == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.print(<span class="string">"Key为空null"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断Key是否为16位</span></span><br><span class="line">        <span class="keyword">if</span> (Key.length() != <span class="number">16</span>) &#123;</span><br><span class="line">            System.out.print(<span class="string">"Key长度不是16位"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] key = Key.getBytes();</span><br><span class="line">        SecretKeySpec keySpec = <span class="keyword">new</span> SecretKeySpec(key, <span class="string">"AES"</span>);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(<span class="string">"AES/CBC/PKCS5Padding"</span>); <span class="comment">//"算法/模式/补码方式"</span></span><br><span class="line">        </span><br><span class="line">        String IV=<span class="string">"20150116"</span>;</span><br><span class="line">        StringBuffer buffer = <span class="keyword">new</span> StringBuffer(<span class="number">16</span>);  </span><br><span class="line">        buffer.append(IV);</span><br><span class="line">        <span class="keyword">while</span> (buffer.length() &lt; <span class="number">16</span>) &#123;  <span class="comment">//IV不足则在末尾填充'\0'补足</span></span><br><span class="line">        	buffer.append(<span class="string">"\0"</span>);  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">if</span> (buffer.length() &gt; <span class="number">16</span>)  &#123;    <span class="comment">//IV超过长度则截取 </span></span><br><span class="line">            buffer.setLength(<span class="number">16</span>);  </span><br><span class="line">        &#125; </span><br><span class="line">    </span><br><span class="line">        IvParameterSpec iv = <span class="keyword">new</span> IvParameterSpec(buffer.toString().getBytes());<span class="comment">//使用CBC模式，需要一个向量iv，可增加加密算法的强度</span></span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv);</span><br><span class="line">        <span class="keyword">byte</span>[] encrypted = cipher.doFinal(Src.getBytes());</span><br><span class="line">        <span class="comment">/*原始加密数据</span></span><br><span class="line"><span class="comment">          for (int i = 0; i &lt; encrypted.length; i ++) &#123;</span></span><br><span class="line"><span class="comment">              System.out.printf("0x%02X ", encrypted[i]);               </span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BASE64Encoder().encode(encrypted);<span class="comment">//此处使用BASE64做转码功能，同时能起到2次加密的作用。</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// AES/CBC/PKCS5Padding 解密  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Decrypt</span><span class="params">(String Src, String Key)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 判断Key是否正确</span></span><br><span class="line">            <span class="keyword">if</span> (Key == <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">"Key为空null"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 判断Key是否为16位</span></span><br><span class="line">            <span class="keyword">if</span> (Key.length() != <span class="number">16</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">"Key长度不是16位"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">byte</span>[] key = Key.getBytes(<span class="string">"ASCII"</span>);</span><br><span class="line">            SecretKeySpec keySpec = <span class="keyword">new</span> SecretKeySpec(key, <span class="string">"AES"</span>);</span><br><span class="line">            Cipher cipher = Cipher.getInstance(<span class="string">"AES/CBC/PKCS5Padding"</span>);</span><br><span class="line">            </span><br><span class="line">            String IV=<span class="string">"20150116"</span>;</span><br><span class="line">            StringBuffer buffer = <span class="keyword">new</span> StringBuffer(<span class="number">16</span>);  </span><br><span class="line">            buffer.append(IV);</span><br><span class="line">            <span class="keyword">while</span> (buffer.length() &lt; <span class="number">16</span>) &#123;  </span><br><span class="line">                buffer.append(<span class="string">"\0"</span>);  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">if</span> (buffer.length() &gt; <span class="number">16</span>) &#123;  </span><br><span class="line">                buffer.setLength(<span class="number">16</span>);  </span><br><span class="line">            &#125; </span><br><span class="line">            </span><br><span class="line">            IvParameterSpec iv = <span class="keyword">new</span> IvParameterSpec(buffer.toString().getBytes());</span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, keySpec, iv);</span><br><span class="line">            <span class="keyword">byte</span>[] encrypted1 = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(Src);<span class="comment">//先用base64解密</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">byte</span>[] original = cipher.doFinal(encrypted1);</span><br><span class="line">                String originalString = <span class="keyword">new</span> String(original);</span><br><span class="line">                <span class="keyword">return</span> originalString;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(e.toString());</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            System.out.println(ex.toString());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">   <span class="comment">//AES/ECB/NoPadding 解密     </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Decrypt2</span><span class="params">(<span class="keyword">byte</span>[] Src, String Key)</span> <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 判断Key是否正确</span></span><br><span class="line">            <span class="keyword">if</span> (Key == <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">"Key为空null"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 判断Key是否为16位</span></span><br><span class="line">            <span class="keyword">if</span> (Key.length() != <span class="number">16</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">"Key长度不是16位"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">byte</span>[] key = Key.getBytes(<span class="string">"ASCII"</span>);</span><br><span class="line">            SecretKeySpec keySpec = <span class="keyword">new</span> SecretKeySpec(key, <span class="string">"AES"</span>);</span><br><span class="line">            Cipher cipher = Cipher.getInstance(<span class="string">"AES/ECB/NoPadding"</span>);</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">           </span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, keySpec);</span><br><span class="line">            <span class="keyword">byte</span>[] encrypted1 = Src;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">byte</span>[] original = cipher.doFinal(encrypted1);</span><br><span class="line">                String originalString = <span class="keyword">new</span> String(original);</span><br><span class="line">                <span class="keyword">return</span> originalString;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(e.toString());</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            System.out.println(ex.toString());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * 加密用的Key 可以用26个字母和数字组成，最好不要用保留字符，虽然不会错，至于怎么裁决，个人看情况而定</span></span><br><span class="line"><span class="comment">         * 此处使用AES-128-CBC加密模式，key需要为16位。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String Key = <span class="string">"DATA_KEY20150116"</span>;</span><br><span class="line">        <span class="comment">// 需要加密的字串</span></span><br><span class="line">        String Src = <span class="string">"&#123;\"data\":&#123;\"page\":1,\"pageSize\":100&#125;,\"device\":\"android\",\"imei\":\"867514021468675\",\"mac\":\"\",\"token\":\"\",\"versionId\":\"4.2.9\"&#125;"</span>;</span><br><span class="line">        System.out.println(Src);</span><br><span class="line">        <span class="comment">// 加密</span></span><br><span class="line">        String enString = AES.Encrypt(Src, Key);</span><br><span class="line">        System.out.println(<span class="string">"加密后的字串是："</span> + enString);</span><br><span class="line"></span><br><span class="line">       </span><br><span class="line">        <span class="comment">// 解密</span></span><br><span class="line">        String DeString = AES.Decrypt(enString, Key);</span><br><span class="line">        System.out.println(<span class="string">"解密后的字串是："</span> + DeString);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">byte</span>[] cipher = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;(<span class="keyword">byte</span>)<span class="number">0x46</span>,(<span class="keyword">byte</span>)<span class="number">0x00</span>,(<span class="keyword">byte</span>)<span class="number">0x94</span>,(<span class="keyword">byte</span>)<span class="number">0x74</span>,(<span class="keyword">byte</span>)<span class="number">0x1F</span>,(<span class="keyword">byte</span>)<span class="number">0xAB</span>,(<span class="keyword">byte</span>)<span class="number">0x14</span>,(<span class="keyword">byte</span>)<span class="number">0xF0</span>,(<span class="keyword">byte</span>)<span class="number">0xB2</span>,(<span class="keyword">byte</span>)<span class="number">0x59</span>,(<span class="keyword">byte</span>)<span class="number">0xA9</span>,(<span class="keyword">byte</span>)<span class="number">0x19</span>,(<span class="keyword">byte</span>)<span class="number">0xC0</span>,(<span class="keyword">byte</span>)<span class="number">0x43</span>,(<span class="keyword">byte</span>)<span class="number">0xDC</span>,(<span class="keyword">byte</span>)<span class="number">0xC3</span>&#125;;</span><br><span class="line">        Key=<span class="string">"com.example.forc"</span>;</span><br><span class="line">        String flag = AES.Decrypt2(cipher, Key);</span><br><span class="line">        System.out.println(<span class="string">"flag是："</span> + flag);</span><br><span class="line">        </span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidAlgorithmParameterException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.InvalidKeySpecException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DES</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// The initialization vector(IV) should be 8 bytes  </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] EncryptionIV = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;<span class="number">18</span>, <span class="number">52</span>, <span class="number">86</span>, <span class="number">120</span>, -<span class="number">112</span>, -<span class="number">85</span>, -<span class="number">51</span>, -<span class="number">17</span>&#125;;  <span class="comment">//初始化向量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] key = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;<span class="number">88</span>,<span class="number">81</span>,-<span class="number">114</span>,<span class="number">39</span>,-<span class="number">127</span>,-<span class="number">23</span>,<span class="number">64</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchAlgorithmException, InvalidKeyException, InvalidKeySpecException, NoSuchPaddingException, InvalidAlgorithmParameterException, IllegalBlockSizeException, BadPaddingException, IOException </span>&#123;</span><br><span class="line">		String plainText =<span class="string">"&#123;\"data\":&#123;\"activityIds\":\"\",\"longitude\":116.356247,\"latitude\":39.964974&#125;,\"clientInfo\":\"23000,yingyongbao,1,44400\",\"token\":\"\",\"version\":1&#125;"</span>;  </span><br><span class="line">	      </span><br><span class="line">	    DESKeySpec keySpec = <span class="keyword">new</span> DESKeySpec(key);  </span><br><span class="line">	    SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(<span class="string">"DES"</span>);  </span><br><span class="line">	    SecretKey secretKey = keyFactory.generateSecret(keySpec);  <span class="comment">//密钥生成器产生真正的DES密钥 </span></span><br><span class="line">	    IvParameterSpec iv = <span class="keyword">new</span> IvParameterSpec(EncryptionIV);  </span><br><span class="line">	    Cipher cipher = Cipher.getInstance(<span class="string">"DES/CBC/PKCS5Padding"</span>); </span><br><span class="line">        </span><br><span class="line">	    cipher.init(Cipher.ENCRYPT_MODE, secretKey, iv);  </span><br><span class="line">	    <span class="keyword">byte</span>[] cipherData = cipher.doFinal(plainText.getBytes());  </span><br><span class="line">	    System.out.println(<span class="string">"加密 ："</span>+<span class="keyword">new</span> BASE64Encoder().encode(cipherData));  </span><br><span class="line">	      </span><br><span class="line">	    cipher.init(Cipher.DECRYPT_MODE, secretKey, iv);  </span><br><span class="line">	    <span class="keyword">byte</span>[] plainData = cipher.doFinal(cipherData);  </span><br><span class="line">	    System.out.println(<span class="string">"解密 ："</span>+<span class="keyword">new</span> String(plainData));</span><br><span class="line">	    </span><br><span class="line">	    <span class="keyword">byte</span>[] ReturnData=<span class="keyword">new</span> BASE64Decoder().decodeBuffer(<span class="string">"Aw4bp9aZGPM2QzQYAoWdXjdVLBJZ1mc1rzmdypgsntqQ2nc4KZHfJn3FtcXYmCKRdmXMSKN1IS3s3p2fpUzM+JaW0uov4S4/CGgroLzK4KOtCnvG6kBM4IwfqEMiJtY6DFpLl8I70JZmfKzj8k6mATKu/4vohNQFQrviikJuiZtIbkQa7SAFTA=="</span>);</span><br><span class="line">	    cipher.init(Cipher.DECRYPT_MODE, secretKey, iv);  </span><br><span class="line">	    <span class="keyword">byte</span>[] ReturnData2 = cipher.doFinal(ReturnData);  </span><br><span class="line">	    System.out.println(<span class="string">"服务器的数据解密 ："</span>+<span class="keyword">new</span> String(ReturnData2));    		</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.InvalidKeySpecException;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;  </span><br><span class="line"><span class="keyword">import</span> java.security.spec.RSAPublicKeySpec;  </span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1、公钥加密，私钥解密用于信息加密</span></span><br><span class="line"><span class="comment"> * 2、私钥加密，公钥解密用于数字签名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RSA</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InvalidKeySpecException </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchAlgorithmException </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchAlgorithmException, InvalidKeySpecException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String publicKey = <span class="string">"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCLNbmKl9/gLn7Bef/xtUkshC1WyrLZLRpXCcFYR1gQi0isWsZBTicC4efBOkkNG3r+1ue0gvtuU/tjREFGf4Y7HaKHGb5tNCOlMNeNjM5YLRwLFqrUSsQyD4rj4eua1ltearr24R0HilnTvnQm6Z/UY0s21vdOUFQBPY0GNAa+0wIDAQAB"</span>;</span><br><span class="line">    	String privateKey = <span class="string">"MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAIs1uYqX3+AufsF5//G1SSyELVbKstktGlcJwVhHWBCLSKxaxkFOJwLh58E6SQ0bev7W57SC+25T+2NEQUZ/hjsdoocZvm00I6Uw142MzlgtHAsWqtRKxDIPiuPh65rWW15quvbhHQeKWdO+dCbpn9RjSzbW905QVAE9jQY0Br7TAgMBAAECgYBcYhbzpr5no/Nyqmf0G/6nkEAWbQYrogbs5AhvcUk8EXL1DnirNhYlj42hafC4xhflrvCtlo8NNKaLxewbwN1uuzG8A2jd+ROEXlx5HDh2ZluhtHzL/SmNcJXo684xAl2pCNVBjDcW48PcIBijke/sTVHTDsDCukLKDPUOM/mKIQJBAL96k4+jBscazsJiuZ6C3RFDVtRRDpf1dMgLgxcx63bAXkA2Arau0J49IAYmSVJoDXqDoJKWdXJVh9vHSkhN/48CQQC6Hk1/G0Y0nOylf6NOp0oMgc0A+etnwxHKqwtctPKjEYcJx2fzALzTtCoySLYXX7gLnPIQXpQBTUysG5skBKp9AkEAiSQm6fqu0Q4fRlRlc+VwpnufhgPkOuw/z0OHiaZkajJPjxfgC63bl2paNG1ZmJ8UAEqkSDlhNxmRa9UqG+1ZewJASaQxz6gwCCNLM1SkfjuM/hPh1JAOh9jUUleJQF5MXx9RSho/VBQnorB3vbutaOQzw0yPLtDtSPKX8sVdhkveVQJAIDsJP5X8Tey6zXTUISor7PF0TSiKdE4k0IwKoy9y8HmQ+AU8+xyr/iOt5lvaGxKlBK8N/7yCw5H4qHnJaHT+Bg=="</span>;</span><br><span class="line">        </span><br><span class="line">        String str = <span class="string">"RSA_By_Java!"</span>;</span><br><span class="line">        <span class="comment">// 公钥加密，私钥解密</span></span><br><span class="line">        String enStr1 = RSA.encryptByPublic(str, publicKey);</span><br><span class="line">        System.out.println(<span class="string">"公钥加密后："</span>+enStr1);</span><br><span class="line">        String deStr1 = RSA.decryptByPrivate(enStr1, privateKey);</span><br><span class="line">        System.out.println(<span class="string">"私钥解密后："</span>+deStr1);</span><br><span class="line">        <span class="comment">// 私钥加密，公钥解密</span></span><br><span class="line">        String enStr2 = RSA.encryptByPrivate(str, privateKey);</span><br><span class="line">        System.out.println(<span class="string">"私钥加密后："</span>+enStr2);</span><br><span class="line">        String deStr2 = RSA.decryptByPublic(enStr2, publicKey);</span><br><span class="line">        System.out.println(<span class="string">"公钥解密后："</span>+deStr2);</span><br><span class="line">        <span class="comment">// 产生签名  </span></span><br><span class="line">        String sign = sign(enStr2, privateKey);</span><br><span class="line">        System.out.println(<span class="string">"签名:"</span>+sign);</span><br><span class="line">        <span class="comment">// 验证签名 </span></span><br><span class="line">        <span class="keyword">boolean</span> status = verify(enStr2, publicKey, sign);</span><br><span class="line">        System.out.println(<span class="string">"状态:"</span>+status);</span><br><span class="line">       </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">"以下为兆金所RSA协议分析"</span>);</span><br><span class="line">        <span class="comment">/*兆金所RSA协议分析</span></span><br><span class="line"><span class="comment">                        原始密钥：OpenSSLRSAPublicKey&#123;modulus=98eaa55cb48cd4e860d41a9568758dcb563166a8e8ef77f1c03023f31d878599447df85c3fbb9279f886fff58936643939957a88187511f149ff710e57e74ca61867b4b3d1dae2da6b0805a8f0ed03eadfac3c508320c47ae472b68ffabf574f39bfd1b75d4499266c5c2d1193923fe793fd40b51cb34ce216e2b8f8ad1e8937,</span></span><br><span class="line"><span class="comment">    	publicExponent=10001&#125;*/</span></span><br><span class="line">        String publicModulus = <span class="string">"98eaa55cb48cd4e860d41a9568758dcb563166a8e8ef77f1c03023f31d878599447df85c3fbb9279f886fff58936643939957a88187511f149ff710e57e74ca61867b4b3d1dae2da6b0805a8f0ed03eadfac3c508320c47ae472b68ffabf574f39bfd1b75d4499266c5c2d1193923fe793fd40b51cb34ce216e2b8f8ad1e8937"</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        	BigInteger keyInt = <span class="keyword">new</span> BigInteger(publicModulus, <span class="number">16</span>);</span><br><span class="line">        	BigInteger exponentInt = <span class="keyword">new</span> BigInteger(<span class="string">"10001"</span>, <span class="number">16</span>);</span><br><span class="line">        	RSAPublicKeySpec keySpeck = <span class="keyword">new</span> RSAPublicKeySpec(keyInt, exponentInt);</span><br><span class="line">        	KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">        	PublicKey PublicKey = keyFactory.generatePublic(keySpeck);</span><br><span class="line">        	System.out.println(PublicKey);  </span><br><span class="line">        	</span><br><span class="line">        	<span class="comment">// 返回加密后由Base64编码的加密信息</span></span><br><span class="line">        	<span class="keyword">byte</span>[] data =<span class="string">"&#123;\"Page\":\"1\",\"pageSize\":\"5\"&#125;"</span>.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line">        	Cipher v0 = Cipher.getInstance(<span class="string">"RSA/ECB/PKCS1Padding"</span>);</span><br><span class="line">        	v0.init(<span class="number">1</span>, ((Key)PublicKey));</span><br><span class="line">        	<span class="keyword">byte</span>[]  v2 = v0.doFinal(data);</span><br><span class="line">        	System.out.println(encryptBase64(v2));</span><br><span class="line">        	String Signature = URLEncoder.encode(encryptBase64(v2), <span class="string">"utf-8"</span>);   <span class="comment">//URL编码</span></span><br><span class="line">        	System.out.println(Signature);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公钥加密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptingStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> publicKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encryptByPublic</span><span class="params">(String encryptingStr, String publicKeyStr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 将公钥由字符串转为UTF-8格式的字节数组</span></span><br><span class="line">            <span class="keyword">byte</span>[] publicKeyBytes = decryptBase64(publicKeyStr);</span><br><span class="line">            <span class="comment">// 获得公钥  </span></span><br><span class="line">            X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(publicKeyBytes);</span><br><span class="line">            <span class="comment">// 取得待加密数据</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = encryptingStr.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line">            KeyFactory factory;</span><br><span class="line">            factory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">            PublicKey publicKey = factory.generatePublic(keySpec);</span><br><span class="line">            <span class="comment">// 对数据加密  </span></span><br><span class="line">            Cipher cipher = Cipher.getInstance(factory.getAlgorithm());</span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line">            <span class="comment">// 返回加密后由Base64编码的加密信息</span></span><br><span class="line">            <span class="keyword">return</span> encryptBase64(cipher.doFinal(data));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;     </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 私钥解密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptedStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> privateKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">decryptByPrivate</span><span class="params">(String encryptedStr, String privateKeyStr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 对私钥解密  </span></span><br><span class="line">            <span class="keyword">byte</span>[] privateKeyBytes = decryptBase64(privateKeyStr);</span><br><span class="line">            <span class="comment">// 获得私钥 </span></span><br><span class="line">            PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(privateKeyBytes);</span><br><span class="line">            <span class="comment">// 获得待解密数据</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = decryptBase64(encryptedStr);</span><br><span class="line">            KeyFactory factory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">            PrivateKey privateKey = factory.generatePrivate(keySpec);</span><br><span class="line">            <span class="comment">// 对数据解密</span></span><br><span class="line">            Cipher cipher = Cipher.getInstance(factory.getAlgorithm());</span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br><span class="line">            <span class="comment">// 返回UTF-8编码的解密信息</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(cipher.doFinal(data), <span class="string">"UTF-8"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;      </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 私钥加密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptingStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> privateKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encryptByPrivate</span><span class="params">(String encryptingStr, String privateKeyStr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] privateKeyBytes = decryptBase64(privateKeyStr);</span><br><span class="line">            <span class="comment">// 获得私钥  </span></span><br><span class="line">            PKCS8EncodedKeySpec keySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(privateKeyBytes); </span><br><span class="line">            <span class="comment">// 取得待加密数据</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = encryptingStr.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line">            KeyFactory factory = KeyFactory.getInstance(<span class="string">"RSA"</span>);  </span><br><span class="line">            PrivateKey privateKey = factory.generatePrivate(keySpec); </span><br><span class="line">            <span class="comment">// 对数据加密 </span></span><br><span class="line">            Cipher cipher = Cipher.getInstance(factory.getAlgorithm());  </span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, privateKey);</span><br><span class="line">            <span class="comment">// 返回加密后由Base64编码的加密信息</span></span><br><span class="line">            <span class="keyword">return</span> encryptBase64(cipher.doFinal(data));  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 公钥解密</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptedStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> privateKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">decryptByPublic</span><span class="params">(String encryptedStr, String publicKeyStr)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 对公钥解密  </span></span><br><span class="line">            <span class="keyword">byte</span>[] publicKeyBytes = decryptBase64(publicKeyStr);</span><br><span class="line">            <span class="comment">// 取得公钥  </span></span><br><span class="line">            X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(publicKeyBytes);</span><br><span class="line">            <span class="comment">// 取得待加密数据</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = decryptBase64(encryptedStr);</span><br><span class="line">            KeyFactory factory = KeyFactory.getInstance(<span class="string">"RSA"</span>);  </span><br><span class="line">            PublicKey publicKey = factory.generatePublic(keySpec);</span><br><span class="line">            <span class="comment">// 对数据解密  </span></span><br><span class="line">            Cipher cipher = Cipher.getInstance(factory.getAlgorithm());  </span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, publicKey);</span><br><span class="line">            <span class="comment">// 返回UTF-8编码的解密信息</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(cipher.doFinal(data), <span class="string">"UTF-8"</span>);  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用私钥对加密数据进行签名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptedStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> privateKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">sign</span><span class="params">(String encryptedStr, String privateKey)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">""</span>;  </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//将私钥加密数据字符串转换为字节数组</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = encryptedStr.getBytes();</span><br><span class="line">            <span class="comment">// 解密由base64编码的私钥  </span></span><br><span class="line">            <span class="keyword">byte</span>[] bytes = decryptBase64(privateKey);  </span><br><span class="line">            <span class="comment">// 构造PKCS8EncodedKeySpec对象  </span></span><br><span class="line">            PKCS8EncodedKeySpec pkcs = <span class="keyword">new</span> PKCS8EncodedKeySpec(bytes);  </span><br><span class="line">            <span class="comment">// 指定的加密算法  </span></span><br><span class="line">            KeyFactory factory = KeyFactory.getInstance(<span class="string">"RSA"</span>);  </span><br><span class="line">            <span class="comment">// 取私钥对象  </span></span><br><span class="line">            PrivateKey key = factory.generatePrivate(pkcs);  </span><br><span class="line">            <span class="comment">// 用私钥对信息生成数字签名  </span></span><br><span class="line">            Signature signature = Signature.getInstance(<span class="string">"SHA1withRSA"</span>);  </span><br><span class="line">            signature.initSign(key);  </span><br><span class="line">            signature.update(data);  </span><br><span class="line">            str = encryptBase64(signature.sign());  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> str;  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 校验数字签名 </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> encryptedStr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> publicKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sign</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 校验成功返回true，失败返回false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String encryptedStr, String publicKey, String sign)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//将私钥加密数据字符串转换为字节数组</span></span><br><span class="line">            <span class="keyword">byte</span>[] data = encryptedStr.getBytes();</span><br><span class="line">            <span class="comment">// 解密由base64编码的公钥  </span></span><br><span class="line">            <span class="keyword">byte</span>[] bytes = decryptBase64(publicKey);  </span><br><span class="line">            <span class="comment">// 构造X509EncodedKeySpec对象  </span></span><br><span class="line">            X509EncodedKeySpec keySpec = <span class="keyword">new</span> X509EncodedKeySpec(bytes);  </span><br><span class="line">            <span class="comment">// 指定的加密算法  </span></span><br><span class="line">            KeyFactory factory = KeyFactory.getInstance(<span class="string">"RSA"</span>);  </span><br><span class="line">            <span class="comment">// 取公钥对象  </span></span><br><span class="line">            PublicKey key = factory.generatePublic(keySpec);  </span><br><span class="line">            <span class="comment">// 用公钥验证数字签名  </span></span><br><span class="line">            Signature signature = Signature.getInstance(<span class="string">"SHA1withRSA"</span>);  </span><br><span class="line">            signature.initVerify(key);  </span><br><span class="line">            signature.update(data);  </span><br><span class="line">            flag = signature.verify(decryptBase64(sign));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">return</span> flag;  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * BASE64 解码 </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 需要Base64解码的字符串 </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 字节数组 </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] decryptBase64(String key) &#123;</span><br><span class="line">        <span class="keyword">return</span> Base64.getDecoder().decode(key);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * BASE64 编码 </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key 需要Base64编码的字节数组 </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 字符串 </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encryptBase64</span><span class="params">(<span class="keyword">byte</span>[] key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(Base64.getEncoder().encode(key));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="sha-x-和-md5"><a href="#sha-x-和-md5" class="headerlink" title="sha-x 和 md5"></a>sha-x 和 md5</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SHA_1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		String v0_1,v0_2,v0_3;</span><br><span class="line">		v0_1 = SHA1(<span class="string">"手机号码13665422381"</span>);</span><br><span class="line">		System.out.println(<span class="string">"SHA1加密完成："</span>+v0_1);  <span class="comment">//sha1加密完成</span></span><br><span class="line">		System.out.println(<span class="string">"SHA1加密完成（大写）："</span>+v0_1.toUpperCase());  <span class="comment">//sha1加密完成</span></span><br><span class="line">		v0_2 =MD5(<span class="string">"手机号码13665422381"</span>);</span><br><span class="line">		System.out.println(<span class="string">"MD5加密完成："</span>+v0_2);  <span class="comment">//sha1加密完成</span></span><br><span class="line">		System.out.println(<span class="string">"MD5加密完成（大写）："</span>+v0_2.toUpperCase());  <span class="comment">//sha1加密完成</span></span><br><span class="line">		v0_3 = SHA256(<span class="string">"手机号码13665422381"</span>);</span><br><span class="line">		System.out.println(<span class="string">"SHA256加密完成："</span>+v0_3);  <span class="comment">//sha1加密完成</span></span><br><span class="line">		System.out.println(<span class="string">"SHA256加密完成（大写）："</span>+v0_3.toUpperCase());  <span class="comment">//sha1加密完成</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String <span class="title">SHA1</span><span class="params">(String string)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">try</span> &#123;</span><br><span class="line">	        MessageDigest digest = MessageDigest.getInstance(<span class="string">"SHA-1"</span>);</span><br><span class="line">	        digest.update(string.getBytes(<span class="string">"UTF-8"</span>));  <span class="comment">//不设置编码的话中文加密会错误</span></span><br><span class="line">	        <span class="keyword">byte</span> messageDigest[] = digest.digest();</span><br><span class="line">	        <span class="comment">// Create Hex String</span></span><br><span class="line">	        StringBuffer hexString = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">	        <span class="comment">// 字节数组转换为十六进制 数</span></span><br><span class="line">	        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; messageDigest.length; i++) &#123;</span><br><span class="line">	            String shaHex = Integer.toHexString(messageDigest[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">	            <span class="keyword">if</span> (shaHex.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">	                hexString.append(<span class="number">0</span>);</span><br><span class="line">	            &#125;</span><br><span class="line">	            hexString.append(shaHex);</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">return</span> hexString.toString();</span><br><span class="line"></span><br><span class="line">	       &#125; <span class="keyword">catch</span> (UnsupportedEncodingException | NoSuchAlgorithmException e) &#123;</span><br><span class="line">	         e.printStackTrace();&#125;</span><br><span class="line">	    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String <span class="title">SHA256</span><span class="params">(String string)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">try</span> &#123;</span><br><span class="line">	        MessageDigest digest = MessageDigest.getInstance(<span class="string">"SHA-256"</span>);</span><br><span class="line">	        digest.update(string.getBytes(<span class="string">"UTF-8"</span>));  <span class="comment">//不设置编码的话中文加密会错误</span></span><br><span class="line">	        <span class="keyword">byte</span> messageDigest[] = digest.digest();</span><br><span class="line">	        <span class="comment">// Create Hex String</span></span><br><span class="line">	        StringBuffer hexString = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">	        <span class="comment">// 字节数组转换为十六进制 数</span></span><br><span class="line">	        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; messageDigest.length; i++) &#123;</span><br><span class="line">	            String shaHex = Integer.toHexString(messageDigest[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">	            <span class="keyword">if</span> (shaHex.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">	                hexString.append(<span class="number">0</span>);</span><br><span class="line">	            &#125;</span><br><span class="line">	            hexString.append(shaHex);</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">return</span> hexString.toString();</span><br><span class="line"></span><br><span class="line">	       &#125; <span class="keyword">catch</span> (UnsupportedEncodingException | NoSuchAlgorithmException e) &#123;</span><br><span class="line">	         e.printStackTrace();&#125;</span><br><span class="line">	    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String <span class="title">MD5</span><span class="params">(String string)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> hexDigits[] = &#123; <span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>&#125;;<span class="comment">// 用来将字节转换成 16 进制表示的字符</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">       </span><br><span class="line">        MessageDigest mdTemp = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">        mdTemp.update(string.getBytes(<span class="string">"UTF-8"</span>));  <span class="comment">//不设置编码的话中文加密会错误</span></span><br><span class="line">        <span class="keyword">byte</span> tmp[] = mdTemp.digest(); <span class="comment">// MD5 的计算结果是一个 128 位的长整数，</span></span><br><span class="line">        <span class="comment">// 用字节表示就是 16 个字节</span></span><br><span class="line">        <span class="keyword">char</span> str[] = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">16</span> * <span class="number">2</span>]; <span class="comment">// 每个字节用 16 进制表示的话，使用两个字符，</span></span><br><span class="line">        <span class="comment">// 所以表示成 16 进制需要 32 个字符</span></span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>; <span class="comment">// 表示转换结果中对应的字符位置</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123; <span class="comment">// 从第一个字节开始，对 MD5 的每一个字节</span></span><br><span class="line">            <span class="comment">// 转换成 16 进制字符的转换</span></span><br><span class="line">            <span class="keyword">byte</span> byte0 = tmp[i]; <span class="comment">// 取第 i 个字节</span></span><br><span class="line">            str[k++] = hexDigits[byte0 &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>]; <span class="comment">// 取字节中高 4 位的数字转换,</span></span><br><span class="line">            <span class="comment">// &gt;&gt;&gt; 为逻辑右移，将符号位一起右移</span></span><br><span class="line">            str[k++] = hexDigits[byte0 &amp; <span class="number">0xf</span>]; <span class="comment">// 取字节中低 4 位的数字转换</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(str); <span class="comment">// 换后的结果转换为字符串</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (UnsupportedEncodingException | NoSuchAlgorithmException e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>持续更新ing</p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#android逆向" >
    <span class="tag-code">android逆向</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2020/01/13/dex-file-structure/">
        <span class="nav-arrow">← </span>
        
          dex文件结构
        
      </a>
    
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
      <div class="money-like">
        <div class="reward-btn">
          赏
          <span class="money-code">
            <span class="alipay-code">
              <div class="code-image"></div>
              <b>使用微信打赏</b>
            </span>
            <span class="wechat-code">
              <div class="code-image"></div>
              <b>请作者喝咖啡</b>
            </span>
          </span>
        </div>
        <!-- <p class="notice">若你觉得我的文章对你有帮助，欢迎点击上方按钮对我打赏</p> -->
        <p class="notice"> <b>读后有收获可以使用微信支付请作者喝咖啡:) </b></p>

        
      </div>
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
    <!-- 二维码 END -->
    
      <!-- No Comment -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#AES"><span class="toc-nav-text">AES</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#DES"><span class="toc-nav-text">DES</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#RSA"><span class="toc-nav-text">RSA</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#sha-x-和-md5"><span class="toc-nav-text">sha-x 和 md5</span></a></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://yoursite.com/2020/02/13/APP-common-encrypt-java/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>







    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2023 | 鹿桥 </a>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">
    总访问量<span id="busuanzi_value_site_pv"></span>次
    </span>
    <span id="busuanzi_container_page_pv">
    本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>    

    <!-- <br>
    Theme by <a href="https://github.com/yanm1ng" target="_blank" rel="noopener">yanm1ng</a> -->
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->



<script src="/js/script.js"></script>



  </body>
</html>